import pytest
from logbesselk.tensorflow import sign_bessel_k


@pytest.mark.parametrize('v, x, m, n, sign', [
    (1., 1., 0, 0, +1.),
    (1., 1., 0, 1, -1.),
    (1., 1., 0, 2, +1.),
    (1., 1., 0, 3, -1.),
    (1., 1., 1, 0, +1.),
    (1., 1., 1, 1, -1.),
    (1., 1., 1, 2, +1.),
    (1., 1., 1, 3, -1.),
    (1., 1., 2, 0, +1.),
    (1., 1., 2, 1, -1.),
    (1., 1., 2, 2, +1.),
    (1., 1., 2, 3, -1.),
    (1., 1., 3, 0, +1.),
    (1., 1., 3, 1, -1.),
    (1., 1., 3, 2, +1.),
    (1., 1., 3, 3, -1.),
    (-1., 1., 0, 0, +1.),
    (-1., 1., 0, 1, -1.),
    (-1., 1., 0, 2, +1.),
    (-1., 1., 0, 3, -1.),
    (-1., 1., 1, 0, -1.),
    (-1., 1., 1, 1, +1.),
    (-1., 1., 1, 2, -1.),
    (-1., 1., 1, 3, +1.),
    (-1., 1., 2, 0, +1.),
    (-1., 1., 2, 1, -1.),
    (-1., 1., 2, 2, +1.),
    (-1., 1., 2, 3, -1.),
    (-1., 1., 3, 0, -1.),
    (-1., 1., 3, 1, +1.),
    (-1., 1., 3, 2, -1.),
    (-1., 1., 3, 3, +1.),
])
def test_sign(v, x, m, n, sign):
    assert sign_bessel_k(v, x, m, n).numpy() == sign
