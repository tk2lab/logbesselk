[tool.poetry]
name = "logbesselk"
version = "3.3.0"
description = "Provide function to calculate the modified Bessel function of the second kind"
license = "Apache-2.0"
authors = ["TAKEKAWA Takashi <takekawa@tk2lab.org>"]
readme = "README.md"
repository = "https://github.com/tk2lab/logbesselk"

[build-system]
requires = ["poetry-core>=1.0.0"]
build-backend = "poetry.core.masonry.api"

[tool.poetry.dependencies]
python = ">=3.8,<3.13"
#tensorflow = ">=2.6,<2.12"
#jax = "^0.2+cuda"

[tool.pytest.ini_options]
markers = [
    "vec",
]

[tool.ruff]
target-versin = "py310"

[tool.ruff.format]
quote-style = "single"

[tool.ruff.lint]
select = ["E4", "E7", "E9", "F", "W", "N", "I"]

[ttol.ruff.lint.per-file-ignores]
"__init__.py" = ["F401"]

[tool.ruff.lint.isort]
combine-as-imports = true
force-wrap-aliases = true
split-on-trailing-comma = true

[tool.tox]
legacy_tox_ini = """
[tox]
min_version = 4.0
isolated_build = True
env_list = 
    py{310,311,312}-jax{3,4}
    py{310,311,312}-tf{29,210,211,212,213,214,215,216}
    lint
    eval_tf
    eval_jax

[gh-actions]
python =
    3.10: py310-jax3, py310-tf29
    3.12: py312-jax4, py312-tf216

[testenv:py{310,311,312}-jax{3,4}]
deps =
    jax3: jax[cuda] (>=0.3,<0.4)
    jax4: jax[cuda] (>=0.4,<0.5)
    pytest
    pandas
install_command =
    pip install --upgrade -f https://storage.googleapis.com/jax-releases/jax_cuda_releases.html {opts} {packages}
commands =
    {envpython} -m pytest tests/test_jax.py {posargs}

[testenv:py{310,311,312}-tf{29,210,211,212,213,214,215,216}]
deps =
    tf29: tensorflow (>=2.9,<2.10)
    tf210: tensorflow (>=2.10,<2.11)
    tf211: tensorflow (>=2.11,<2.12)
    tf212: tensorflow (>=2.12,<2.13)
    tf213: tensorflow (>=2.13,<2.14)
    tf214: tensorflow (>=2.14,<2.15)
    tf215: tensorflow (>=2.15,<2.16)
    tf216: tensorflow (>=2.16,<2.17)
    pytest
    pandas
commands =
    {envpython} -m pytest tests/test_tensorflow.py {posargs}

[testenv:eval_jax]
deps =
    jax[cuda]
    pandas
install_command =
    pip install --upgrade -f https://storage.googleapis.com/jax-releases/jax_cuda_releases.html {opts} {packages}
commands =
    {envpython} eval/eval_jax.py

[testenv:eval_tf]
deps =
    tensorflow
    pandas
commands =
    {envpython} eval/eval_tensorflow.py
"""
